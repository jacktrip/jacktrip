os:
  - linux
  - osx

language: 
  - cpp

branches:
  - master
  - travis

env:
  global:
  - PKGS_LINUX="qt5-default qttools5-dev-tools libjack-dev librtaudio-dev"
  - PKGS_OSX="jack qt rt-audio"
  
addons:
  apt:
    update: true
    packages:
      - g++-6
      - qt5-default
      - qttools5-dev-tools
      - libjack-dev 
      - librtaudio-dev
  homebrew:
    packages:
      - jack
      - qt
      - rt-audio

before_install:
  # linux: use gcc-6
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then export CC="gcc-6"; export CXX="g++-6"; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo ln -s /usr/bin/gcc-6 /usr/local/bin/gcc; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo ln -s /usr/bin/g++-6 /usr/local/bin/g++; fi
  - gcc -v && g++ -v
  # mac: workaround for homebrew-installed headers
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then export C_INCLUDE_PATH="/usr/local/include"; fi
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then export CPLUS_INCLUDE_PATH="/usr/local/include"; fi
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then export LIBRARY_PATH="/usr/local/lib"; fi
  # mac: workaround for homebrew qmake not being symlinked into $PATH
  # see https://stackoverflow.com/questions/48847505/why-cant-i-use-qmake-on-mac-after-installing-it
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then export PATH="/usr/local/opt/qt/bin:$PATH"; fi

script: 
  - gcc -v && g++ -v
  - cd src
  - ./build
  
after_success:
  - echo "Success!"

after_failure:
  - echo "Something went wrong :("
