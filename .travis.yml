os:
  - linux
  - osx

language: 
  - cpp

dist: bionic

branches:
  - master
  - travis

env:
  global:
  - PKGS_LINUX="qt5-default qttools5-dev-tools libjack-dev librtaudio-dev"
  - PKGS_OSX="jack qt rt-audio"
  
addons:
  apt:
    update: true
    packages:
      - qt5-default
      - qttools5-dev-tools
      - libjack-dev 
      - librtaudio-dev
  homebrew:
    packages:
      - jack
      - qt
      - rt-audio

script: 
  # # linux: force gcc-6
  # - if [ "$TRAVIS_OS_NAME" = "linux" ]; then
  #     sudo update-alternatives --remove-all gcc;
  #     sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-6 90 --slave /usr/bin/g++ g++ /usr/bin/g++-6;
  #   fi
  # mac: workaround for homebrew-installed headers
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then 
      export C_INCLUDE_PATH="/usr/local/include";
      export CPLUS_INCLUDE_PATH="/usr/local/include";
      export LIBRARY_PATH="/usr/local/lib";
    fi
  # mac: workaround for homebrew qmake not being symlinked into $PATH
  # see https://stackoverflow.com/questions/48847505/why-cant-i-use-qmake-on-mac-after-installing-it
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then 
      export PATH="/usr/local/opt/qt/bin:$PATH";
    fi

  - gcc -v && g++ -v
  - cd src
  - ./build
  
after_success:
  - echo "Success!"

after_failure:
  - echo "Something went wrong :("
